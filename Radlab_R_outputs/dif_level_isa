
#Convert to family level
family_radseq <- tax_glom(radseq,"Family", NArm = FALSE)
#Convert to relative abundance
family_radseq_RA <- transform_sample_counts(family_radseq, fun=function(x) x/sum(x))
#Order ISA
family_isa_rad <- multipatt(t(otu_table(family_radseq_RA)), cluster = sample_data(family_radseq_RA)$`ionizing_radiation`)
summary(family_isa_rad) #---> no significant order

head(tax_table(family_radseq_RA))
head(otu_table(family_radseq_RA))
head(family_isa_rad)

fam_taxtable <- tax_table(family_radseq_RA) %>% as.data.frame() %>% rownames_to_column(var="ASV")

# consider that your table is only going to be resolved up to the genus level, be wary of 
# anything beyond the glomed taxa level
family_isa_rad$sign %>%
  rownames_to_column(var="ASV") %>%
  left_join(fam_taxtable) %>%
  filter(p.value<0.05) %>% View()
